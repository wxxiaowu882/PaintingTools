# Gemini优化约束说明 - 绘画工作台项目

## 📋 项目背景
这是"童画师吴晓的绘画工作台"项目，一个为绘画学习者设计的在线辅助工具。项目当前版本为v3.0.0，包含网格起型和色阶概括两大核心功能。

## 🎯 优化范围与目标

### 允许优化的范围：
1. **UI视觉设计优化**
   - 颜色方案、阴影、渐变效果
   - 间距、对齐、字体大小
   - 按钮、滑块、输入框的视觉样式
   - 动画效果和过渡

2. **交互体验优化**
   - 触摸反馈（按下、抬起状态）
   - 手势操作的流畅度
   - 加载状态和等待提示
   - 错误状态和成功反馈

3. **移动端适配优化**
   - 不同屏幕尺寸的响应式调整
   - 触摸目标大小优化
   - 键盘弹出时的布局调整

4. **性能优化（仅限前端）**
   - CSS渲染性能
   - JavaScript执行效率（不改变核心算法）
   - 图片加载优化

### 严格禁止的范围：
1. **文本内容修改**
   - 所有按钮文字、标签、提示文本
   - 品牌名称"童画师吴晓"、"我爱你们"
   - 功能描述和说明文字
   - 社交账号信息

2. **功能逻辑修改**
   - 网格生成算法
   - 色阶量化算法
   - 手势识别逻辑
   - 图片保存和导出逻辑
   - 微信浏览器检测逻辑

3. **文件结构修改**
   - HTML标签结构和ID命名
   - JavaScript函数名称和参数
   - CSS类名和选择器
   - 文件组织方式

4. **兼容性修改**
   - 已解决的移动端兼容性方案
   - Canvas尺寸限制逻辑（2560×2560）
   - 微信浏览器特殊处理

## 🔧 技术约束

### 必须保持的技术特性：
1. **纯原生实现**：无框架依赖（无React/Vue/Angular）
2. **单文件结构**：所有代码在单个HTML文件中
3. **移动优先**：触摸操作优先于鼠标操作
4. **Canvas核心**：所有图像处理基于HTML5 Canvas

### 必须保持的功能：
1. **网格起型工具完整功能链**：
   - 图片上传 → 网格生成 → 参数调整 → 视图操作 → 保存导出
2. **色阶概括工具完整功能链**：
   - 图片上传 → 色阶处理 → 参数调整 → 视图操作 → 保存导出
3. **双模式操作**：
   - 网格工具：移动视图模式 vs 调整网格模式
   - 手势区分：双指缩放 vs 双指拖拽
4. **兼容性要求**：
   - iOS Safari（iPhone/iPad）
   - Android Chrome
   - 微信内置浏览器
   - PC现代浏览器

## 📝 代码修改规则

### 修改原则：
1. **最小化修改**：只修改与UI/交互直接相关的代码
2. **可追溯性**：修改处添加注释说明优化原因
3. **向后兼容**：确保优化后所有原有功能正常工作
4. **渐进增强**：新特性不能破坏旧功能

### CSS修改规范：
```css
/* 允许：优化视觉样式 */
.btn-upload {
  /* 可以修改颜色、阴影、渐变 */
  background: linear-gradient(...);
  box-shadow: ...;
  transition: all 0.3s ease;
}

/* 禁止：修改布局结构 */
.btn-upload {
  /* 不可以修改display、position等影响布局的属性 */
  display: flex; /* 保持原值 */
  position: relative; /* 保持原值 */
}
```

### JavaScript修改规范：
```javascript
// 允许：优化交互反馈
button.addEventListener('click', function() {
  // 可以添加视觉反馈
  this.style.transform = 'scale(0.98)';
  setTimeout(() => {
    this.style.transform = '';
  }, 100);
});

// 禁止：修改功能逻辑
function shareApp() {
  // 不可以修改复制链接的核心逻辑
  // 只能优化UI反馈部分
}
```

## 🧪 测试要求

### 优化后必须验证：
1. **核心功能测试**：
   - [ ] 网格工具：上传图片、调整网格、保存功能正常
   - [ ] 色阶工具：上传图片、调整色阶、保存功能正常
   - [ ] 4联对比图生成正常
   - [ ] 正方形网格切换功能正常

2. **交互测试**：
   - [ ] 双指缩放和拖拽流畅
   - [ ] 按钮点击反馈明确
   - [ ] 滑块操作顺滑
   - [ ] 模态框打开/关闭正常

3. **兼容性测试**：
   - [ ] 移动端（iOS/Android）显示正常
   - [ ] 微信浏览器内功能正常
   - [ ] PC浏览器功能正常

4. **性能测试**：
   - [ ] 页面加载速度不受影响
   - [ ] 图片处理性能不受影响
   - [ ] 内存使用正常

## 📁 项目文件说明

### 主要文件：
- `Index.html`：主文件，包含所有代码
- `需求文档.md`：功能需求和版本记录
- `变更规则.md`：代码修改流程规范
- `Gemini优化约束说明.md`：本文件

### 版本管理：
- 当前版本：v3.0.0（UI整合基线版本）
- 使用语义化版本号：主版本.次版本.修订号
- 重要修改需创建版本备份：`Index_v{版本号}.html`

## 💡 优化建议方向

### 推荐优化点：
1. **视觉一致性**：统一按钮样式、颜色方案
2. **交互反馈**：添加按下状态、加载动画
3. **响应式改进**：优化小屏幕布局
4. **可访问性**：增加适当的ARIA标签
5. **性能微调**：减少重绘、优化事件处理

### 谨慎优化点：
1. **布局结构调整**：可能影响现有功能
2. **JavaScript重构**：可能引入兼容性问题
3. **第三方库引入**：需要严格评估必要性

## 📞 问题处理

### 遇到问题时的处理流程：
1. **首先还原**：如果优化导致功能异常，立即还原修改
2. **记录问题**：详细记录问题现象和复现步骤
3. **最小复现**：创建最小化的测试用例
4. **沟通确认**：如有不确定，先沟通再修改

### 需要沟通的情况：
- 发现现有代码中的潜在bug
- 需要修改功能逻辑才能实现的优化
- 优化可能影响性能或兼容性
- 对修改范围不确定

## ✅ 验收标准

优化完成后，项目应该：
1. ✅ 所有现有功能正常工作
2. ✅ UI更加美观和一致
3. ✅ 交互更加流畅和直观
4. ✅ 移动端体验更好
5. ✅ 性能没有下降
6. ✅ 代码结构保持清晰

---

**重要提醒**：请确保每次修改都是最小化的、可回溯的。如有疑问，宁可保持原状也不要冒险修改不确定的代码。

*文档创建日期：2026-01-24*
*联系人：童画师吴晓团队*